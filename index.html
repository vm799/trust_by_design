
<!DOCTYPE html>
<html lang="en" class="dark">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>JobProof | Professional Field Evidence</title>

  <!-- Favicon & App Icons -->
  <link rel="icon" type="image/svg+xml" href="/favicon.svg">
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
  <link rel="manifest" href="/manifest.json">
  <meta name="theme-color" content="#2563EB">
  <meta name="description" content="Track jobs, prove delivery, win repeat business. Professional field evidence management for contractors.">

  <!-- Content Security Policy - allows Google Fonts, Vercel, Supabase -->
  <!-- NOTE: frame-ancestors removed - it ONLY works in HTTP headers, not meta tags -->
  <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-inline' 'unsafe-eval' https://vercel.live; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com; font-src 'self' https://fonts.gstatic.com; img-src 'self' data: blob: https:; connect-src 'self' https://*.supabase.co wss://*.supabase.co https://worldtimeapi.org https://fonts.googleapis.com https://fonts.gstatic.com https://vercel.live wss://vercel.live; worker-src 'self' blob:; frame-src 'self' https://vercel.live; base-uri 'self'; form-action 'self'">

  <!-- Fonts only - CSS is bundled by Vite -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&family=JetBrains+Mono:wght@400;700&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&display=swap" rel="stylesheet">
  <style>
    /* Critical CSS for instant dark theme - prevents white flash */
    /* Phase 5.5: Force dark-only, no horizontal scroll */
    html {
      overflow-x: hidden;
      max-width: 100vw;
    }
    html, body, #root {
      background-color: #020617; /* slate-950 */
      min-height: 100vh;
    }
    body {
      font-family: 'Inter', sans-serif;
      overflow-x: hidden;
      max-width: 100vw;
      color: #f1f5f9; /* slate-100 */
    }
    #root {
      overflow-x: hidden;
      max-width: 100vw;
    }

    /* Loading spinner shown before React mounts */
    #root:empty::after {
      content: '';
      position: fixed;
      top: 50%;
      left: 50%;
      width: 48px;
      height: 48px;
      border: 4px solid rgba(37, 99, 235, 0.3);
      border-top-color: #2563eb;
      border-radius: 50%;
      animation: spin 1s linear infinite;
      transform: translate(-50%, -50%);
    }
    @keyframes spin { to { transform: translate(-50%, -50%) rotate(360deg); } }

    /* Additional styles */
    .glass { background: rgba(15, 23, 42, 0.8); backdrop-filter: blur(12px); border: 1px solid rgba(255, 255, 255, 0.1); }
    .animate-in { animation: fadeIn 0.4s ease-out; }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    * { font-style: normal !important; }
    input, select, textarea { font-size: 16px !important; }
    canvas { touch-action: none; }

    /* Print styles */
    @media print {
      .no-print, aside, nav, button:not(.print-allow) { display: none !important; }
      body { background: white !important; color: black !important; }
      img { print-color-adjust: exact; -webkit-print-color-adjust: exact; }
    }
  </style>
</head>
<body class="antialiased">
  <div id="root"></div>
  <script type="module" src="/index.tsx"></script>

  <!-- Service Worker Registration for Bunker Mode (Offline-First) -->
  <script>
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('/sw.js')
          .then((registration) => {
            console.log('[SW] Service Worker registered:', registration.scope);

            // Listen for updates
            registration.addEventListener('updatefound', () => {
              const newWorker = registration.installing;
              if (newWorker) {
                newWorker.addEventListener('statechange', () => {
                  if (newWorker.state === 'installed' && navigator.serviceWorker.controller) {
                    console.log('[SW] New version available - refresh to update');
                  }
                });
              }
            });
          })
          .catch((error) => {
            console.warn('[SW] Service Worker registration failed:', error);
          });
      });
    }
  </script>
</body>
</html>
